安装脚手架工具：

```bash
npm i express-generator
```

搭建与启动项目

```bash
express my-blog-server
```

安装相干依赖

```bash
npm i
```

内容变化后避免重复启动需要安装并进行nodemon配置

安装nodemon

```bash
npm i -D nodemon
```

编辑nodemon配置文件nodemon.json

```json
{
  "watch": ["*.js", "*.json"],
  "ignore": ["package*.json", "nodemon.json", "node_modules","public"]
}
```

- watch 监听以js或者json结尾的文件，当文件内容发生变化后重新启动项目
- ignore 忽略指定目录下或指定文件，当这些目录下的文件或指定文件发生变化时，不会重新启动项目

编辑nodemon的npm启动脚本命令

将package.json的script修改为如下配置：

```json
  "scripts": {
    "start": "nodemon -x npm run serve",
    "serve": "node ./bin/www"
  },
```

这样运行npm start命令即可运行nodemon来动态监听文件变化并启动项目

修改启动端口

```bash
// ./bin/www
var port = normalizePort(process.env.PORT || '7001'); //默认端口为3000,你可以在此修改默认的启动端口,这里设置为开发端口的7001
app.set('port', port);
```

设置服务器启动提示：

```js
function onListening() {
  var addr = server.address();
  var bind = typeof addr === 'string'
    ? 'pipe ' + addr
    : 'port ' + addr.port;
  debug('Listening on ' + bind);
  //添加一行
  console.log("服务器已启动，正在监听7001端口")
}
```

运行命令，启动项目：

```bash
npm start
```

在浏览器地址栏输入localhost:7001可以看到Welcome to Express字样，express项目搭建启动成功。

调整目录结构

* 删除模板引擎：删除views目录以及其在根目录的模板引擎引用导入（即app.js中的下面片段需要进行删除）

  ```js
  //app.js
  // view engine setup
  app.set('views', path.join(__dirname, 'views'));
  app.set('view engine', 'jade');
  ```

* 理清三层架构，构建数据访问层（dao目录），逻辑服务层（service目录），界面层（routes目录）

  - dao目录，这里要与数据库打交道，使用sequelize来构建模型实例，定义方法来创建数据库并对数据进行操作和查询
  - service目录,这里主要接受来自路由层的请求，将参数传入并调用数据访问层的方法，其中要运行逻辑判断，如token的生成与验证，验证码的验证等等操作。
  - routes目录，这里主要负责接受来自客户端的请求，并将调用服务层的方法将返回的数据以格式化的形式响应给客户端。

