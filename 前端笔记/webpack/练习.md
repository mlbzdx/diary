按照环境配置webpack

根据环境配置webpack本质上就是配置 `mode` ，当 `mode='development'` 时，为开发环境；当 `mode='produnction'` 时为生产环境。

当`webpack`的配置是一个函数时，可以通过 `--env` 的配置项，通过在其后书写键`key`或者键值 `key=value`，将键值对象传递给函数作为环境参数。(传递给函数的环境参数是一个对象，其中包含着 `--env`传递过来的键值)

通过`–-env`，一些公共的webpack配置，生产环境的配置，开发环境的配置可以通过传参的方式将其进行模块化的分离。

* `package.json`中的脚本命令

  ```json
  {
    "scripts": {
      "dev": "webpack",
      "build": "webpack --env prod"
      //prod传递给webpack的env后，env.prod的值为true
      //即只设置了键的话，那么env.key的默认值为true
      //如果设置了键值，那么env.key的值为value
    },
  }
  ```

* `webpack.common.js`,这里是`webpack`的一些公共配置

  ```js
  module.exports = {
    stats: {
      modules: false,
      //禁用模块信息的输出。默认情况下，webpack 会显示模块信息，包括每个模块的路径、大小等。
      colors: true,
      // 启用彩色文本输出，使得输出更加易读和可视化。默认情况下，webpack 输出是彩色的。
    },
  };
  
  ```

* `webpack.dev.js`,这里是 `webpack`的开发环境的配置

  ```js
  module.exports = {
    mode: "development",
  };
  ```

* `webpack.prod.js` ,这里是 `webpack`的生产环境的配置。

  ```js
  module.exports = {
    mode: "production",
  };
  ```

* `webpack.config.js`,这里是集成后的 `webpack` 的配置。

  ```js
  const commonEnv = require("./webpack.common");
  const devEnv = require("./webpack.dev");
  const prodEnv = require("./webpack.prod");
  
  module.exports = (env) => {
    //这里的env.pro的值为true
    if (env && env.prod) {
      return {
        ...commonEnv,
        ...prodEnv,
      };
    } else {
      return {
        ...commonEnv,
        ...devEnv,
      };
    }
  };
  ```

  