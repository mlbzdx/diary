## `SQL`

###  结构化查询语言

全名： `Structured Query Language `  结构化查询语言

大部分关系型数据，拥有着基本一致的SQL语法

### 分支语言

`DDL`，全名：`Data Definition Language` 数据定义语言 操作数据库对象

* 库
* 表
* 视图
* 存储过程

`DML`，全名：`Data Manipulation Language`  数据操控语言 操作数据库中的记录

`DCL`，全名：`Data Control Language ` 数据控制语句 操作用户权限

## 管理库

创建库

```mysql
create database test;
```

> [!CAUTION]
>
> 注意！如果初次创建库时发生了如下报错，说明该数据库已经存在。
>
> ```erorr
> ERROR 3678 (HY000): Schema directory '.\test' already exists. This must be resolved manually (e.g. by moving the schema directory to another location).
> ```
>
> 但是通过命令显示不出来该数据库，这个时候可以通过以下命令查看数据库的存放地址：
>
> ```mysql
> show variables like '%datadir%';
> ```
>
> 然后切换到存放地址，将该数据库目录删除即可重新创建该数据库。

切换库

```sql
use test;
```

删除库

```sql
drop database test;
```

查看数据库

```mysql
show databases;
```

## 管理表

### 创建表

```
create table 库名 表名 (表中各字段即各列的信息)
```

> ```mysql
> CREATE TABLE users (
>     id INT AUTO_INCREMENT PRIMARY KEY,
>     username VARCHAR(50) NOT NULL,
>     email VARCHAR(100) NOT NULL,
>     created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
> );
> ```
>
> 在上面的示例中，我们创建了一个名为“users”的表。该表包含`id、username、email`和`created_at`列。id列是主键，并设置为自动递增。`username`和email列是字符串类型，且不能为空。`created_at`列是时间戳类型，并设置默认值为当前时间。

创建字段（各列信息）

* 字段名
* 字段类型
  * bit：占1位，0或1，false或true
  * `int`：占32位，整数
  * decimal(M,N)：能精确计算的实数，M是总的数字位数，N是小数位数
  * char(n)：固定长度位n的字符
  * varchar(n)：长度可变，最大长度位n的字符
  * text：大量的字符
  * date：仅日期
  * datetime：日期和时间
  * time：仅时间
* 是不是null
* 自增
* 默认值

### 修改表

要修改现有的表结构，需要使用ALTER TABLE语句。以下是一些常见的示例：

1. 添加新列：

```sql
ALTER TABLE users
ADD COLUMN phone_number VARCHAR(20);
```

2. 修改列的数据类型：

```sql
ALTER TABLE users
MODIFY COLUMN email VARCHAR(150);
```

3. 删除列：

```sql
ALTER TABLE users
DROP COLUMN phone_number;
```

4. 添加主键：

```sql
ALTER TABLE users
ADD PRIMARY KEY (id);
```

5. 添加外键：

```sql
ALTER TABLE orders
ADD FOREIGN KEY (user_id) REFERENCES users(id);
```

### 删除表

要删除表，需要使用DROP TABLE语句。请注意，执行DROP TABLE将永久删除表及其所有数据，因此请谨慎操作。以下是一个示例：

```sql
DROP TABLE users;
```

在上面的示例中，我们删除了名为“users”的表。执行此操作后，表及其所有数据将被永久删除，无法恢复。如果执行命令时不在当前数据库中，那么后面需要写清数据库的名称和表的名称后才可以删除。

```
DROP TABLE DatabaseName.users;
```

## 主键和外键

### 主键

根据设计原则，每张表都要有主键（主键的创建是为了保证表内数据的唯一性），主键的创建要求：

* 唯一
* 不能更改
* 无业务含义，通常使用只在系统内有效的 `id` 来表示

### 外键

用于产生表关系的列，外键列会连接到另一张表（或自己）的主键

## 表关系

### 一对一

一个A对应一个B，一个B对应一个A。例如：用户和用户信息，把任意一张表的主键同时设置为外键

### 一对多

一个A对应多个B，一个B对应一个A，A和B是一对多，B和A是多对一。例如：班级和学生，用户和文章，在多一端的表上设置外键，对应到另一张表的主键。

### 多对多

一个A对应多个B，一个B对应多个A。例如：学生和老师，需要新建一张关系表，关系表至少包含两个外键，分别对应到两张表。

## 数据库的三大设计范式

1. 要求数据库表的每一列都是不可分割的原子数据项
2. 非主键列必须依赖于主键列
3. 非主键列必须直接依赖主键列